<?xml version="1.0" encoding="UTF-8"?>
<rules xmlns="http://scap.nist.gov/schema/content-rules/0.1"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:scap-ds="http://scap.nist.gov/schema/scap/source/1.2"
    xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2"
    xmlns:oval="http://oval.mitre.org/XMLSchema/oval-definitions-5"
    xsi:schemaLocation="http://scap.nist.gov/schema/content-rules/0.1 src/main/xsd/rules.xsd">

    <external-identifiers>
        <external-identifier id="urn:scap-content:external-identifier:org.mitre:cve">
            <pattern expression="CVE-\d{4}-\d{4}"/>
        </external-identifier>
        <external-identifier id="urn:scap-content:external-identifier:org.mitre:cce-4">
            <pattern expression="CCE-\d+"/>
        </external-identifier>
        <external-identifier id="urn:scap-content:external-identifier:org.mitre:cce-5">
            <pattern expression="CCE-\d+-\d"/>
        </external-identifier>
        <external-identifier id="urn:scap-content:external-identifier:org.mitre:cwe">
            <pattern expression="CWE-\d+"/>
        </external-identifier>
        <external-identifier id="urn:scap-content:external-identifier:gov.nist:cpe-2-x">
            <pattern expression="[c][pP][eE]:/[AHOaho]?(:[A-Za-z0-9\._\-~%]*){0,6}"/>
        </external-identifier>
    </external-identifiers>
    
    <!-- SCAP 1.2 Datastream -->
    <schema id="urn:scap-content:schema:gov.nist.scap:datastream-collection-1.2" namespace="http://scap.nist.gov/schema/scap/source/1.2">
        <key id="urn:scap-content:key:gov.nist.scap:datastream-collection">
            <field name="datastream-collection-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="urn:scap-content:key:gov.nist.scap:datastream">
            <field name="datastream-collection-id">
                <key-ref ref-id="urn:scap-content:key:gov.nist.scap:datastream-collection"
                    field="datastream-collection-id"/>
            </field>
            <field name="datastream-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="urn:scap-content:key:gov.nist.scap:component-ref">
            <field name="datastream-collection-id">
                <key-ref ref-id="urn:scap-content:key:gov.nist.scap:datastream-collection"
                    field="datastream-collection-id"/>
            </field>
            <field name="datastream-id">
                <key-ref ref-id="urn:scap-content:key:gov.nist.scap:datastream"
                    field="datastream-id"/>
            </field>
            <field name="component-ref-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="urn:scap-content:key:gov.nist.scap:component">
            <field name="datastream-collection-id">
                <key-ref ref-id="urn:scap-content:key:gov.nist.scap:datastream-collection"
                    field="datastream-collection-id"/>
            </field>
            <field name="component-id">
                <xpath expression="./@id"/>
            </field>
        </key>

        <content-node id="urn:scap-content:content-node:gov.nist.scap:datastream">
            <key ref-id="urn:scap-content:key:gov.nist.scap:datastream"/>
        </content-node>
        
        <content-node id="urn:scap-content:content-node:gov.nist.scap:component-ref">
            <key ref-id="urn:scap-content:key:gov.nist.scap:component-ref"/>
        </content-node>
        
        <content-node id="urn:scap-content:content-node:gov.nist.scap:component">
            <key ref-id="urn:scap-content:key:gov.nist.scap:component"/>
        </content-node>

        <indexed-document id="urn:scap-content:document:gov.nist.scap:datastream-collection" qname="scap-ds:data-stream-collection">
            <key ref-id="urn:scap-content:key:gov.nist.scap:datastream-collection"/>
        </indexed-document>
        <boundary-relationship id="urn:scap-content:relationship:gov.nist.scap:datastream-boundary">
            <entity-ref ref-id="urn:scap-content:document:gov.nist.scap:datastream-collection"/>
            <xpath expression="declare namespace scap='http://scap.nist.gov/schema/scap/source/1.2';./scap:data-stream"/>
            <content-mapping>
                <qname-mapping qname="scap-ds:data-stream" ref-id="urn:scap-content:content-node:gov.nist.scap:datastream"/>
            </content-mapping>
        </boundary-relationship>
        
        <boundary-relationship id="urn:scap-content:relationship:gov.nist.scap:component-boundary">
            <entity-ref ref-id="urn:scap-content:document:gov.nist.scap:datastream-collection"/>
            <xpath expression="declare namespace scap='http://scap.nist.gov/schema/scap/source/1.2';./scap:component"/>
            <content-mapping>
                <qname-mapping qname="scap-ds:component" ref-id="urn:scap-content:content-node:gov.nist.scap:component"/>
            </content-mapping>
        </boundary-relationship>
        
        <boundary-relationship id="urn:scap-content:relationship:gov.nist.scap:component-ref-boundary">
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap:datastream"/>
            <xpath expression="declare namespace scap='http://scap.nist.gov/schema/scap/source/1.2';./*/scap:component-ref"/>
            <content-mapping>
                <qname-mapping qname="scap-ds:component-ref" ref-id="urn:scap-content:content-node:gov.nist.scap:component-ref"/>
            </content-mapping>
        </boundary-relationship>
        
        <boundary-relationship id="urn:scap-content:relationship:gov.nist.scap:component-content-boundary">
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap:component"/>
            <xpath expression="declare namespace scap='http://scap.nist.gov/schema/scap/source/1.2';./*"/>
            <content-mapping>
                <qname-mapping qname="xccdf:Benchmark" ref-id="urn:scap-content:document:gov.nist.scap.xccdf:benchmark"/>
                <qname-mapping qname="oval:oval_definitions" ref-id="urn:scap-content:document:org.mitre.oval:oval-definitions"/>
            </content-mapping>
        </boundary-relationship>
        
        <keyed-relationship id="urn:scap-content:relationship:gov.nist.scap:component-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap:component-ref"/>
            <xpath expression="."/>
            <key-ref ref-id="urn:scap-content:key:gov.nist.scap:component">
                <field name="datastream-collection-id">
                    <key-ref ref-id="urn:scap-content:key:gov.nist.scap:datastream-collection"
                        field="datastream-collection-id"/>
                </field>
                <field name="component-id">
                    <xpath expression="declare namespace xlink='http://www.w3.org/1999/xlink';./@xlink:href"/>
                    <pattern expression="^#(.*)$"/>
                </field>
            </key-ref>
        </keyed-relationship>
    </schema>
    
    <!-- CPE Language 2.3 -->
    <schema id="urn:scap-content:schema:org.mitre.cpe-language:cpe-language-2.0" namespace="http://cpe.mitre.org/language/2.0">
        <key id="urn:scap-content:key:org.mitre.cpe-language:platform">
            <field name="platform-id">
                <xpath expression="@id"/>
            </field>
        </key>

        <content-node id="urn:scap-content:content-node:org.mitre.cpe-language:platform">
            <key ref-id="urn:scap-content:key:org.mitre.cpe-language:platform"/>
        </content-node>

        <indirect-relationship id="urn:scap-content:relationship:org.mitre.cpe-language:fact-ref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.cpe-language:platform"/>
            <xpath expression="declare namespace cpe-lang='http://cpe.mitre.org/language/2.0';.//cpe-lang:fact-ref"/>
            <value>
                <xpath expression="@name"/>
            </value>
            <external-identifier ref-id="urn:scap-content:external-identifier:gov.nist:cpe-2-x"/>
        </indirect-relationship>
        <!-- TODO: handle check-fact-ref -->
    </schema>

    <!-- XCCDF 1.2 -->
    <schema id="urn:scap-content:schema:gov.nist.scap.xccdf:xccdf-1.2" namespace="http://checklists.nist.gov/xccdf/1.2">
        <key id="urn:scap-content:key:gov.nist.scap.xccdf:benchmark">
            <field name="benchmark-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="urn:scap-content:key:gov.nist.scap.xccdf:profile">
            <field name="profile-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="urn:scap-content:key:gov.nist.scap.xccdf:item">
            <field name="item-id">
                <xpath expression="./@id"/>
            </field>
        </key>

        <content-node id="urn:scap-content:content-node:gov.nist.scap.xccdf:profile">
            <key ref-id="urn:scap-content:key:gov.nist.scap.xccdf:profile"/>
        </content-node>
        
        <content-node id="urn:scap-content:content-node:gov.nist.scap.xccdf:rule">
            <key ref-id="urn:scap-content:key:gov.nist.scap.xccdf:item"/>
        </content-node>
        
        <content-node id="urn:scap-content:content-node:gov.nist.scap.xccdf:group">
            <key ref-id="urn:scap-content:key:gov.nist.scap.xccdf:item"/>
        </content-node>
        
        <content-node id="urn:scap-content:content-node:gov.nist.scap.xccdf:value">
            <key ref-id="urn:scap-content:key:gov.nist.scap.xccdf:item"/>
        </content-node>

        <indexed-document id="urn:scap-content:document:gov.nist.scap.xccdf:benchmark" qname="xccdf:Benchmark">
            <key ref-id="urn:scap-content:key:gov.nist.scap.xccdf:benchmark"/>
        </indexed-document>

        <boundary-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:benchmark-profile-boundary">
            <entity-ref ref-id="urn:scap-content:document:gov.nist.scap.xccdf:benchmark"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:Profile"/>
            <content-mapping>
                <qname-mapping qname="xccdf:Profile" ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:profile"/>
            </content-mapping>
        </boundary-relationship>
        
        <boundary-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:benchmark-platform-definition-boundary">
            <entity-ref ref-id="urn:scap-content:document:gov.nist.scap.xccdf:benchmark"/>
            <xpath expression="declare namespace cpe-lang='http://cpe.mitre.org/language/2.0';cpe-lang:platform-specification/cpe-lang:platform"/>
            <content-mapping>
                <default ref-id="urn:scap-content:content-node:org.mitre.cpe-language:platform"/>
            </content-mapping>
        </boundary-relationship>
        
        <boundary-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:benchmark-item-boundary">
            <entity-ref ref-id="urn:scap-content:document:gov.nist.scap.xccdf:benchmark"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:Rule|xccdf:Group|xccdf:Value"/>
            <content-mapping>
                <qname-mapping qname="xccdf:Group" ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:group"/>
                <qname-mapping qname="xccdf:Rule" ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:rule"/>
                <qname-mapping qname="xccdf:Value" ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:value"/>
            </content-mapping>
        </boundary-relationship>
        
        <boundary-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:group-item-boundary">
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:group"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:Rule|xccdf:Group|xccdf:Value"/>
            <content-mapping>
                <qname-mapping qname="xccdf:Group" ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:group"/>
                <qname-mapping qname="xccdf:Rule" ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:rule"/>
                <qname-mapping qname="xccdf:Value" ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:value"/>
            </content-mapping>
        </boundary-relationship>

        <keyed-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:profile-selector-item-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:profile"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:select|xccdf:refine-value|xccdf:refine-rule|xccdf:set-value|xccdf:set-complex-value"/>
            <key-ref ref-id="urn:scap-content:key:gov.nist.scap.xccdf:item">
                <field name="item-id">
                    <xpath expression="@idref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <indirect-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:selectable-item-ident">
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:rule"/>
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:group"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:ident"/>
            <value>
                <xpath expression="text()"/>
            </value>
            <qualifier-mapping>
                <xpath expression="@system"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:org.mitre:cce-4" qualifier-value="cce.mitre.org/version/4"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:org.mitre:cce-5" qualifier-value="http://cce.mitre.org"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:gov.nist:cpe-2-x" qualifier-value="http://cpe.mitre.org"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:org.mitre:cve" qualifier-value="http://cve.mitre.org"/>
            </qualifier-mapping>
        </indirect-relationship>

        <keyed-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:rule-check-export-value-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:rule"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:check/xccdf:check-export"/>
            <key-ref ref-id="urn:scap-content:key:gov.nist.scap.xccdf:item">
                <field name="item-id">
                    <xpath expression="@value-id"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <keyed-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:selectable-item-requires-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:rule"/>
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:group"/>
            <xpath expression="tokenize(*[local-name()='requires' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2']/@idref,'\s+')"/>
            <key-ref ref-id="urn:scap-content:key:gov.nist.scap.xccdf:item">
                <field name="item-id">
                    <xpath expression="."/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:selectable-item-conflicts-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:rule"/>
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:group"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:conflicts"/>
            <key-ref ref-id="urn:scap-content:key:gov.nist.scap.xccdf:item">
                <field name="item-id">
                    <xpath expression="@idref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <keyed-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:platform-platform-keyref">
            <entity-ref ref-id="urn:scap-content:document:gov.nist.scap.xccdf:benchmark"/>
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:profile"/>
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:rule"/>
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:group"/>
            <!-- TODO: support fix -->
            <xpath expression="*[local-name()='platform' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2' and starts-with(@idref,'#')]"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.cpe-language:platform">
                <field name="platform-id">
                    <xpath expression="substring(@idref,2)"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <indirect-relationship id="urn:scap-content:relationship:gov.nist.scap.xccdf:platform-cpe">
            <entity-ref ref-id="urn:scap-content:document:gov.nist.scap.xccdf:benchmark"/>
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:profile"/>
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:rule"/>
            <entity-ref ref-id="urn:scap-content:content-node:gov.nist.scap.xccdf:group"/>
            <!-- TODO: support fix -->
            <xpath expression="*[local-name()='platform' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2' and not(starts-with(@idref,'#'))]"/>
            <value>
                <xpath expression="@idref"/>
            </value>
            <external-identifier ref-id="urn:scap-content:external-identifier:gov.nist:cpe-2-x"/>
        </indirect-relationship>
        <!-- TODO: handle fix -->
        <!-- TODO: handle uses of cluster ids -->
        <!-- TODO: add check-export to check variable -->
        <!-- TODO: add check-content-ref to check -->
        <!-- TODO: parse out version and associate with content-nodes -->
    </schema>
    
    <!-- OVAL 5 definition -->
    <schema id="urn:scap-content:schema:org.mitre.oval:definition-5" namespace="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        
        <key id="urn:scap-content:key:org.mitre.oval:definition">
            <field name="definition-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="urn:scap-content:key:org.mitre.oval:test">
            <field name="test-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="urn:scap-content:key:org.mitre.oval:object">
            <field name="object-id">
                <xpath expression="./@id"/>
            </field>
        </key>

        <key id="urn:scap-content:key:org.mitre.oval:state">
            <field name="state-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="urn:scap-content:key:org.mitre.oval:variable">
            <field name="variable-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <content-node id="urn:scap-content:content-node:org.mitre.oval:definition">
            <key ref-id="urn:scap-content:key:org.mitre.oval:definition"/>
        </content-node>
        
        <content-node id="urn:scap-content:content-node:org.mitre.oval:test">
            <key ref-id="urn:scap-content:key:org.mitre.oval:test"/>
        </content-node>
        
        <content-node id="urn:scap-content:content-node:org.mitre.oval:object">
            <key ref-id="urn:scap-content:key:org.mitre.oval:object"/>
        </content-node>

        <content-node id="urn:scap-content:content-node:org.mitre.oval:state">
            <key ref-id="urn:scap-content:key:org.mitre.oval:state"/>
        </content-node>
        
        <content-node id="urn:scap-content:content-node:org.mitre.oval:variable">
            <key ref-id="urn:scap-content:key:org.mitre.oval:variable"/>
        </content-node>
        
        <generated-document id="urn:scap-content:document:org.mitre.oval:oval-definitions" qname="oval:oval_definitions"/>

        <!-- oval-definitions relationships -->
        <boundary-relationship id="urn:scap-content:relationship:org.mitre.oval:definitions-boundary">
            <entity-ref ref-id="urn:scap-content:document:org.mitre.oval:oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:definitions/oval:definition"/>
            <content-mapping>
                <qname-mapping qname="oval:definition" ref-id="urn:scap-content:content-node:org.mitre.oval:definition"/>
            </content-mapping>
        </boundary-relationship>

        <boundary-relationship id="urn:scap-content:relationship:org.mitre.oval:tests-boundary">
            <entity-ref ref-id="urn:scap-content:document:org.mitre.oval:oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:tests/*"/>
            <content-mapping>
                <default ref-id="urn:scap-content:content-node:org.mitre.oval:test"/>
            </content-mapping>
        </boundary-relationship>

        <boundary-relationship id="urn:scap-content:relationship:org.mitre.oval:objects-boundary">
            <entity-ref ref-id="urn:scap-content:document:org.mitre.oval:oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:objects/*"/>
            <content-mapping>
                <default ref-id="urn:scap-content:content-node:org.mitre.oval:object"/>
            </content-mapping>
        </boundary-relationship>

        <boundary-relationship id="urn:scap-content:relationship:org.mitre.oval:states-boundary">
            <entity-ref ref-id="urn:scap-content:document:org.mitre.oval:oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:states/*"/>
            <content-mapping>
                <default ref-id="urn:scap-content:content-node:org.mitre.oval:state"/>
            </content-mapping>
        </boundary-relationship>
        
        <boundary-relationship id="urn:scap-content:relationship:org.mitre.oval:variables-boundary">
            <entity-ref ref-id="urn:scap-content:document:org.mitre.oval:oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:variables/*"/>
            <content-mapping>
                <default ref-id="urn:scap-content:content-node:org.mitre.oval:variable"/>
            </content-mapping>
        </boundary-relationship>

        <!-- definition relationships -->
        <indirect-relationship id="urn:scap-content:relationship:org.mitre.oval:definition-reference">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:definition"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:metadata/oval:reference"/>
            <value>
                <xpath expression="@ref_id"/>
            </value>
            <qualifier-mapping>
                <xpath expression="@source"/>
                <!-- TODO: verify that this is a complete mapping -->
                <external-identifier ref-id="urn:scap-content:external-identifier:org.mitre:cce-4" qualifier-value="cce.mitre.org/version/4"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:org.mitre:cce-5" qualifier-value="http://cce.mitre.org"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:org.mitre:cce-5" qualifier-value="CCE"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:org.mitre:cve" qualifier-value="CVE"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:org.mitre:cve" qualifier-value="http://cve.mitre.org"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:gov.nist:cpe-2-x" qualifier-value="CPE"/>
                <external-identifier ref-id="urn:scap-content:external-identifier:gov.nist:cpe-2-x" qualifier-value="http://cpe.mitre.org"/>
            </qualifier-mapping>
        </indirect-relationship>

        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:extend-definition-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:definition"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:extend_definition"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:definition">
                <field name="definition-id">
                    <xpath expression="@definition_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:criterion-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:definition"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:criterion"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:test">
                <field name="test-id">
                    <xpath expression="@test_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <!-- test relationships -->
        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:test-object-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:test"/>
            <xpath expression=".//*[local-name()='object' and namespace-uri()='http://oval.mitre.org/XMLSchema/oval-definitions-5']"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:object">
                <field name="object-id">
                    <xpath expression="@object_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:test-state-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:test"/>
            <xpath expression=".//*[local-name()='state' and namespace-uri()='http://oval.mitre.org/XMLSchema/oval-definitions-5']"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:state">
                <field name="state-id">
                    <xpath expression="@state_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <!-- object relationships -->
        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:object-set-object-reference-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:object"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:set/oval:object_reference"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:object">
                <field name="object-id">
                    <xpath expression="text()"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:object-set-filter-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:object"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:set/oval:filter"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:state">
                <field name="state-id">
                    <xpath expression="text()"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:object-var-ref-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:object"/>
            <xpath expression=".//*[@var_ref]"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:variable">
                <field name="variable-id">
                    <xpath expression="@var_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <!-- state relationships -->
        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:state-var-ref-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:state"/>
            <xpath expression=".//*[@var_ref]"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:variable">
                <field name="variable-id">
                    <xpath expression="@var_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <!-- variable relationships -->
        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:variable-object-ref-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:variable"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:object_component"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:object">
                <field name="object-id">
                    <xpath expression="@object_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <keyed-relationship id="urn:scap-content:relationship:org.mitre.oval:variable-var-ref-keyref">
            <entity-ref ref-id="urn:scap-content:content-node:org.mitre.oval:variable"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:variable_component"/>
            <key-ref ref-id="urn:scap-content:key:org.mitre.oval:variable">
                <field name="variable-id">
                    <xpath expression="@var_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <!-- TODO: parse out version and associate with content-nodes -->
    </schema>
</rules>