<?xml version="1.0" encoding="UTF-8"?>
<rules xmlns="http://scap.nist.gov/schema/content-rules/0.1"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:scap-ds="http://scap.nist.gov/schema/scap/source/1.2"
    xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2"
    xmlns:oval="http://oval.mitre.org/XMLSchema/oval-definitions-5"
    xsi:schemaLocation="http://scap.nist.gov/schema/content-rules/0.1 ../../main/xsd/rules.xsd">

    <external-identifiers>
        <external-identifier id="http://cve.mitre.org/resource/content/cve#external-identifier-cve">
            <pattern expression="CVE-\d{4}-\d{4}"/>
        </external-identifier>
        <external-identifier id="http://cce.mitre.org/resource/content/cce#external-identifier-cce-4">
            <pattern expression="CCE-\d+"/>
        </external-identifier>
        <external-identifier id="http://cce.mitre.org/resource/content/cce#external-identifier-cce-5">
            <pattern expression="CCE-\d+-\d"/>
        </external-identifier>
        <external-identifier id="http://cwe.mitre.org/resource/content/cwe#external-identifier-cwe">
            <pattern expression="CWE-\d+"/>
        </external-identifier>
        <external-identifier id="http://scap.nist.gov/resource/content/cpe/2.x#external-identifier-cpe">
            <pattern expression="[c][pP][eE]:/[AHOaho]?(:[A-Za-z0-9\._\-~%]*){0,6}"/>
        </external-identifier>
    </external-identifiers>
    
    <!-- SCAP 1.2 Datastream -->
    <schema id="http://scap.nist.gov/resource/content/source/1.2#schema" namespace="http://scap.nist.gov/schema/scap/source/1.2">
        <key id="http://scap.nist.gov/resource/content/source/1.2#key-datastream-collection">
            <field name="datastream-collection-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="http://scap.nist.gov/resource/content/source/1.2#key-datastream">
            <field name="datastream-collection-id">
                <key-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#key-datastream-collection"
                    field="datastream-collection-id"/>
            </field>
            <field name="datastream-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="http://scap.nist.gov/resource/content/source/1.2#key-component-ref">
            <field name="datastream-collection-id">
                <key-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#key-datastream-collection"
                    field="datastream-collection-id"/>
            </field>
            <field name="datastream-id">
                <key-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#key-datastream"
                    field="datastream-id"/>
            </field>
            <field name="component-ref-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="http://scap.nist.gov/resource/content/source/1.2#key-component">
            <field name="datastream-collection-id">
                <key-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#key-datastream-collection"
                    field="datastream-collection-id"/>
            </field>
            <field name="component-id">
                <xpath expression="./@id"/>
            </field>
        </key>

        <content-node id="http://scap.nist.gov/resource/content/source/1.2#content-node-datastream">
            <key ref-id="http://scap.nist.gov/resource/content/source/1.2#key-datastream"/>
        </content-node>
        
        <content-node id="http://scap.nist.gov/resource/content/source/1.2#content-node-component-ref">
            <key ref-id="http://scap.nist.gov/resource/content/source/1.2#key-component-ref"/>
        </content-node>
        
        <content-node id="http://scap.nist.gov/resource/content/source/1.2#content-node-component">
            <key ref-id="http://scap.nist.gov/resource/content/source/1.2#key-component"/>
        </content-node>

        <indexed-document id="http://scap.nist.gov/resource/content/source/1.2#document-datastream-collection" qname="scap-ds:data-stream-collection">
            <key ref-id="http://scap.nist.gov/resource/content/source/1.2#key-datastream-collection"/>
        </indexed-document>

        <composite-relationship id="http://scap.nist.gov/resource/content/source/1.2#relationship-datastream-boundary">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#document-datastream-collection"/>
            <xpath expression="declare namespace scap='http://scap.nist.gov/schema/scap/source/1.2';./scap:data-stream"/>
            <content-mapping>
                <qname-mapping qname="scap-ds:data-stream" ref-id="http://scap.nist.gov/resource/content/source/1.2#content-node-datastream"/>
            </content-mapping>
        </composite-relationship>
        
        <composite-relationship id="http://scap.nist.gov/resource/content/source/1.2#relationship-component-boundary">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#document-datastream-collection"/>
            <xpath expression="declare namespace scap='http://scap.nist.gov/schema/scap/source/1.2';./scap:component"/>
            <content-mapping>
                <qname-mapping qname="scap-ds:component" ref-id="http://scap.nist.gov/resource/content/source/1.2#content-node-component"/>
            </content-mapping>
        </composite-relationship>
        
        <composite-relationship id="http://scap.nist.gov/resource/content/source/1.2#relationship-component-ref-boundary">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#content-node-datastream"/>
            <xpath expression="declare namespace scap='http://scap.nist.gov/schema/scap/source/1.2';./*/scap:component-ref"/>
            <content-mapping>
                <qname-mapping qname="scap-ds:component-ref" ref-id="http://scap.nist.gov/resource/content/source/1.2#content-node-component-ref"/>
            </content-mapping>
        </composite-relationship>
        
        <composite-relationship id="http://scap.nist.gov/resource/content/source/1.2#relationship-component-content-boundary">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#content-node-component"/>
            <xpath expression="declare namespace scap='http://scap.nist.gov/schema/scap/source/1.2';./*"/>
            <content-mapping>
                <qname-mapping qname="xccdf:Benchmark" ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#document-benchmark"/>
                <qname-mapping qname="oval:oval_definitions" ref-id="http://oval.mitre.org/resource/content/definition/5#document-oval-definitions"/>
            </content-mapping>
        </composite-relationship>
        
        <keyed-relationship id="http://scap.nist.gov/resource/content/source/1.2#relationship-component-keyref">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#content-node-component-ref"/>
            <xpath expression="."/>
            <key-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#key-component">
                <field name="datastream-collection-id">
                    <key-ref ref-id="http://scap.nist.gov/resource/content/source/1.2#key-datastream-collection"
                        field="datastream-collection-id"/>
                </field>
                <field name="component-id">
                    <xpath expression="declare namespace xlink='http://www.w3.org/1999/xlink';./@xlink:href"/>
                    <pattern expression="^#(.*)$"/>
                </field>
            </key-ref>
        </keyed-relationship>
    </schema>
    
    <!-- CPE Language 2.3 -->
    <schema id="http://cpe.mitre.org/resource/content/cpe-language/2.x#schema" namespace="http://cpe.mitre.org/language/2.0">
        <key id="http://cpe.mitre.org/resource/content/cpe-language/2.x#key-platform">
            <field name="platform-id">
                <xpath expression="@id"/>
            </field>
        </key>

        <content-node id="http://cpe.mitre.org/resource/content/cpe-language/2.x#content-node-platform">
            <key ref-id="http://cpe.mitre.org/resource/content/cpe-language/2.x#key-platform"/>
        </content-node>

        <boundary-identifier-relationship id="http://cpe.mitre.org/resource/content/cpe-language/2.x#relationship-fact-ref">
            <entity-ref ref-id="http://cpe.mitre.org/resource/content/cpe-language/2.x#content-node-platform"/>
            <xpath expression="declare namespace cpe-lang='http://cpe.mitre.org/language/2.0';.//cpe-lang:fact-ref"/>
            <value>
                <xpath expression="@name"/>
            </value>
            <external-identifier ref-id="http://scap.nist.gov/resource/content/cpe/2.x#external-identifier-cpe"/>
        </boundary-identifier-relationship>
        <!-- TODO: handle check-fact-ref -->
    </schema>

    <!-- XCCDF 1.2 -->
    <schema id="http://scap.nist.gov/resource/content/xccdf/1.2#schema" namespace="http://checklists.nist.gov/xccdf/1.2">
        <key id="http://scap.nist.gov/resource/content/xccdf/1.2#key-benchmark">
            <field name="benchmark-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="http://scap.nist.gov/resource/content/xccdf/1.2#key-profile">
            <field name="profile-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="http://scap.nist.gov/resource/content/xccdf/1.2#key-item">
            <field name="item-id">
                <xpath expression="./@id"/>
            </field>
        </key>

        <content-node id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-profile">
            <key ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#key-profile"/>
            <version method="TEXT" use-parent-version-when-undefined="true">
                <xpath expression="*[local-name()='version' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2']/text()"/>
            </version>
        </content-node>
        
        <content-node id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-rule">
            <key ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#key-item"/>
            <version method="TEXT" use-parent-version-when-undefined="true">
                <xpath expression="*[local-name()='version' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2']/text()"/>
            </version>
        </content-node>
        
        <content-node id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-group">
            <key ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#key-item"/>
            <version method="TEXT" use-parent-version-when-undefined="true">
                <xpath expression="*[local-name()='version' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2']/text()"/>
            </version>
        </content-node>
        
        <content-node id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-value">
            <key ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#key-item"/>
            <version method="TEXT" use-parent-version-when-undefined="true">
                <xpath expression="*[local-name()='version' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2']/text()"/>
            </version>
        </content-node>

        <indexed-document id="http://scap.nist.gov/resource/content/xccdf/1.2#document-benchmark" qname="xccdf:Benchmark">
            <key ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#key-benchmark"/>
            <version method="TEXT">
                <xpath expression="*[local-name()='version' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2']/text()"/>
            </version>
        </indexed-document>

        <composite-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-benchmark-profile-boundary">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#document-benchmark"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:Profile"/>
            <content-mapping>
                <qname-mapping qname="xccdf:Profile" ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-profile"/>
            </content-mapping>
        </composite-relationship>
        
        <composite-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-benchmark-platform-definition-boundary">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#document-benchmark"/>
            <xpath expression="declare namespace cpe-lang='http://cpe.mitre.org/language/2.0';cpe-lang:platform-specification/cpe-lang:platform"/>
            <content-mapping>
                <default ref-id="http://cpe.mitre.org/resource/content/cpe-language/2.x#content-node-platform"/>
            </content-mapping>
        </composite-relationship>
        
        <composite-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-benchmark-item-boundary">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#document-benchmark"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:Rule|xccdf:Group|xccdf:Value"/>
            <content-mapping>
                <qname-mapping qname="xccdf:Group" ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-group"/>
                <qname-mapping qname="xccdf:Rule" ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-rule"/>
                <qname-mapping qname="xccdf:Value" ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-value"/>
            </content-mapping>
        </composite-relationship>
        
        <composite-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-group-item-boundary">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-group"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:Rule|xccdf:Group|xccdf:Value"/>
            <content-mapping>
                <qname-mapping qname="xccdf:Group" ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-group"/>
                <qname-mapping qname="xccdf:Rule" ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-rule"/>
                <qname-mapping qname="xccdf:Value" ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-value"/>
            </content-mapping>
        </composite-relationship>

        <keyed-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-profile-selector-item-keyref">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-profile"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:select|xccdf:refine-value|xccdf:refine-rule|xccdf:set-value|xccdf:set-complex-value"/>
            <key-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#key-item">
                <field name="item-id">
                    <xpath expression="@idref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <boundary-identifier-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-selectable-item-ident">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-rule"/>
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-group"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:ident"/>
            <value>
                <xpath expression="text()"/>
            </value>
            <qualifier-mapping>
                <xpath expression="@system"/>
                <external-identifier ref-id="http://cce.mitre.org/resource/content/cce#external-identifier-cce-4" qualifier-value="cce.mitre.org/version/4"/>
                <external-identifier ref-id="http://cce.mitre.org/resource/content/cce#external-identifier-cce-5" qualifier-value="http://cce.mitre.org"/>
                <external-identifier ref-id="http://scap.nist.gov/resource/content/cpe/2.x#external-identifier-cpe" qualifier-value="http://cpe.mitre.org"/>
                <external-identifier ref-id="http://cve.mitre.org/resource/content/cve#external-identifier-cve" qualifier-value="http://cve.mitre.org"/>
            </qualifier-mapping>
        </boundary-identifier-relationship>

        <keyed-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-rule-check-export-value-keyref">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-rule"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:check/xccdf:check-export"/>
            <key-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#key-item">
                <field name="item-id">
                    <xpath expression="@value-id"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <keyed-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-selectable-item-requires-keyref">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-rule"/>
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-group"/>
            <xpath expression="tokenize(*[local-name()='requires' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2']/@idref,'\s+')"/>
            <key-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#key-item">
                <field name="item-id">
                    <xpath expression="."/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-selectable-item-conflicts-keyref">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-rule"/>
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-group"/>
            <xpath expression="declare namespace xccdf='http://checklists.nist.gov/xccdf/1.2';xccdf:conflicts"/>
            <key-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#key-item">
                <field name="item-id">
                    <xpath expression="@idref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <keyed-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-platform-platform-keyref">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#document-benchmark"/>
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-profile"/>
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-rule"/>
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-group"/>
            <!-- TODO: support fix -->
            <xpath expression="*[local-name()='platform' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2' and starts-with(@idref,'#')]"/>
            <key-ref ref-id="http://cpe.mitre.org/resource/content/cpe-language/2.x#key-platform">
                <field name="platform-id">
                    <xpath expression="substring(@idref,2)"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <boundary-identifier-relationship id="http://scap.nist.gov/resource/content/xccdf/1.2#relationship-platform-cpe">
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#document-benchmark"/>
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-profile"/>
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-rule"/>
            <entity-ref ref-id="http://scap.nist.gov/resource/content/xccdf/1.2#content-node-group"/>
            <!-- TODO: support fix -->
            <xpath expression="*[local-name()='platform' and namespace-uri()='http://checklists.nist.gov/xccdf/1.2' and not(starts-with(@idref,'#'))]"/>
            <value>
                <xpath expression="@idref"/>
            </value>
            <external-identifier ref-id="http://scap.nist.gov/resource/content/cpe/2.x#external-identifier-cpe"/>
        </boundary-identifier-relationship>
        <!-- TODO: handle fix -->
        <!-- TODO: handle uses of cluster ids -->
        <!-- TODO: add check-export to check variable -->
        <!-- TODO: add check-content-ref to check -->
    </schema>
    
    <!-- OVAL 5 definition -->
    <schema id="http://oval.mitre.org/resource/content/definition/5#schema" namespace="http://oval.mitre.org/XMLSchema/oval-definitions-5">
        
        <key id="http://oval.mitre.org/resource/content/definition/5#key-definition">
            <field name="definition-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="http://oval.mitre.org/resource/content/definition/5#key-test">
            <field name="test-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="http://oval.mitre.org/resource/content/definition/5#key-object">
            <field name="object-id">
                <xpath expression="./@id"/>
            </field>
        </key>

        <key id="http://oval.mitre.org/resource/content/definition/5#key-state">
            <field name="state-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <key id="http://oval.mitre.org/resource/content/definition/5#key-variable">
            <field name="variable-id">
                <xpath expression="./@id"/>
            </field>
        </key>
        
        <content-node id="http://oval.mitre.org/resource/content/definition/5#content-node-definition">
            <key ref-id="http://oval.mitre.org/resource/content/definition/5#key-definition"/>
            <version method="SERIAL">
                <xpath expression="@version"/>
            </version>
        </content-node>
        
        <content-node id="http://oval.mitre.org/resource/content/definition/5#content-node-test">
            <key ref-id="http://oval.mitre.org/resource/content/definition/5#key-test"/>
            <version method="SERIAL">
                <xpath expression="@version"/>
            </version>
        </content-node>
        
        <content-node id="http://oval.mitre.org/resource/content/definition/5#content-node-object">
            <key ref-id="http://oval.mitre.org/resource/content/definition/5#key-object"/>
            <version method="SERIAL">
                <xpath expression="@version"/>
            </version>
        </content-node>

        <content-node id="http://oval.mitre.org/resource/content/definition/5#content-node-state">
            <key ref-id="http://oval.mitre.org/resource/content/definition/5#key-state"/>
            <version method="SERIAL">
                <xpath expression="@version"/>
            </version>
        </content-node>
        
        <content-node id="http://oval.mitre.org/resource/content/definition/5#content-node-variable">
            <key ref-id="http://oval.mitre.org/resource/content/definition/5#key-variable"/>
            <version method="SERIAL">
                <xpath expression="@version"/>
            </version>
        </content-node>
        
        <generated-document id="http://oval.mitre.org/resource/content/definition/5#document-oval-definitions" qname="oval:oval_definitions"/>

        <!-- oval-definitions relationships -->
        <composite-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-definitions-boundary">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#document-oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:definitions/oval:definition"/>
            <content-mapping>
                <qname-mapping qname="oval:definition" ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-definition"/>
            </content-mapping>
        </composite-relationship>

        <composite-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-tests-boundary">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#document-oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:tests/*"/>
            <content-mapping>
                <default ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-test"/>
            </content-mapping>
        </composite-relationship>

        <composite-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-objects-boundary">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#document-oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:objects/*"/>
            <content-mapping>
                <default ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-object"/>
            </content-mapping>
        </composite-relationship>

        <composite-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-states-boundary">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#document-oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:states/*"/>
            <content-mapping>
                <default ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-state"/>
            </content-mapping>
        </composite-relationship>
        
        <composite-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-variables-boundary">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#document-oval-definitions"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:variables/*"/>
            <content-mapping>
                <default ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-variable"/>
            </content-mapping>
        </composite-relationship>

        <!-- definition relationships -->
        <boundary-identifier-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-definition-reference">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-definition"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';oval:metadata/oval:reference"/>
            <value>
                <xpath expression="@ref_id"/>
            </value>
            <qualifier-mapping>
                <xpath expression="@source"/>
                <!-- TODO: verify that this is a complete mapping -->
                <external-identifier ref-id="http://cce.mitre.org/resource/content/cce#external-identifier-cce-4" qualifier-value="cce.mitre.org/version/4"/>
                <external-identifier ref-id="http://cce.mitre.org/resource/content/cce#external-identifier-cce-5" qualifier-value="http://cce.mitre.org"/>
                <external-identifier ref-id="http://cce.mitre.org/resource/content/cce#external-identifier-cce-5" qualifier-value="CCE"/>
                <external-identifier ref-id="http://cve.mitre.org/resource/content/cve#external-identifier-cve" qualifier-value="CVE"/>
                <external-identifier ref-id="http://cve.mitre.org/resource/content/cve#external-identifier-cve" qualifier-value="http://cve.mitre.org"/>
                <external-identifier ref-id="http://scap.nist.gov/resource/content/cpe/2.x#external-identifier-cpe" qualifier-value="CPE"/>
                <external-identifier ref-id="http://scap.nist.gov/resource/content/cpe/2.x#external-identifier-cpe" qualifier-value="http://cpe.mitre.org"/>
            </qualifier-mapping>
        </boundary-identifier-relationship>

        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-extend-definition-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-definition"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:extend_definition"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-definition">
                <field name="definition-id">
                    <xpath expression="@definition_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-criterion-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-definition"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:criterion"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-test">
                <field name="test-id">
                    <xpath expression="@test_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <!-- test relationships -->
        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-test-object-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-test"/>
            <xpath expression=".//*[local-name()='object' and namespace-uri()='http://oval.mitre.org/XMLSchema/oval-definitions-5']"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-object">
                <field name="object-id">
                    <xpath expression="@object_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-test-state-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-test"/>
            <xpath expression=".//*[local-name()='state' and namespace-uri()='http://oval.mitre.org/XMLSchema/oval-definitions-5']"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-state">
                <field name="state-id">
                    <xpath expression="@state_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <!-- object relationships -->
        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-object-set-object-reference-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-object"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:set/oval:object_reference"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-object">
                <field name="object-id">
                    <xpath expression="text()"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-object-set-filter-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-object"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:set/oval:filter"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-state">
                <field name="state-id">
                    <xpath expression="text()"/>
                </field>
            </key-ref>
        </keyed-relationship>
        
        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-object-var-ref-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-object"/>
            <xpath expression=".//*[@var_ref]"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-variable">
                <field name="variable-id">
                    <xpath expression="@var_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <!-- state relationships -->
        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-state-var-ref-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-state"/>
            <xpath expression=".//*[@var_ref]"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-variable">
                <field name="variable-id">
                    <xpath expression="@var_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <!-- variable relationships -->
        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-variable-object-ref-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-variable"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:object_component"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-object">
                <field name="object-id">
                    <xpath expression="@object_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>

        <keyed-relationship id="http://oval.mitre.org/resource/content/definition/5#relationship-variable-var-ref-keyref">
            <entity-ref ref-id="http://oval.mitre.org/resource/content/definition/5#content-node-variable"/>
            <xpath expression="declare namespace oval='http://oval.mitre.org/XMLSchema/oval-definitions-5';.//oval:variable_component"/>
            <key-ref ref-id="http://oval.mitre.org/resource/content/definition/5#key-variable">
                <field name="variable-id">
                    <xpath expression="@var_ref"/>
                </field>
            </key-ref>
        </keyed-relationship>
    </schema>
</rules>